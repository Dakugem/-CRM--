**EBKO-CRM** -- система, позволяющая организовать взаимодействие телекоммуникационной компании и клиентов в B2B сегменте. Система объединяет в себе фукционал модулей:
- **NRI (Network Resource Inventory)**: Учет сетевых ресурсов и оборудования
- **КТП (Комплекс Технической Поддержки)**: Обработка инцидентов и заявок от клиентов
- **WFM (Workforce Management)**: Управление персоналом на линиях (задачи для монтажников/инженеров)

# Техническое задание на разработку системы EBKO-CRM

## 1. Введение
### 1.1 Глоссарий
- **Клиент (Заявитель)** - юридическое лицо, пользующееся услугами компании
- **Представитель клиента** - контактное лицо, уполномленное создавать обращения от имени клиента
- **Площадка** - физический адрес (объект), где расположено оборудование клиента
- **Продукт** - Услуга или самостоятельный продукт предоставляемый компанией. Может иметь следующие значения:
   - МКД (Мультисервисный коммутатор доступа) - Программный или аппаратный комплекс для организации IP-телефонии в поколеннии NGN
   - Интернет - сумма всех необходимых транков, аппаратных комплексов для предоставления доступа в сеть Интернет
   - IP-телефония - сумма всех необходимых транков, аппаратных комплексов для организации IP-телефонии
-  **Единица оборудования** - отдельное штучное оборудование, предоставляемое в рамках продукта
-  **Артикул** - идентификатор единицы оборудования. Имеет следующий формат:
   - Для МКД: 1001 + XXXXXXXXXX (14 символов)
   - Для Интернет: 2002 + XXXXXXXXXX (14 символов)
   - Для IP-телефония: 3003 + XXXXXXXXXX (14 символов)
- **Тип единицы оборудования** - классификационный признак единицы оборудования, бывает:
   - абонентское
   - пассивные сетевые установки
   - системы коммутации
   - ПО
- **Предоставляемое оборудование** - список единиц оборудования предоставляемых в n-ом количестве конкретной площадке, конркетного заказчика
- **Обращение** - обобщённая сущность для заявок КТП и задач WFM. Может быть типа:
   - **Тикет (КТП-обращение)** - обращение,  требующее экспертизы оператора техподдержки
   - **Наряд (WFM-обращение)** - обращение, требующее выезда инженера
- **Подзадача** - дочернее обращение, связанное с родительским
- **Сотрудник** - работник компании (оператор КТП, инженер WFM, администратор)
- **Роль** - набор прав доступа (Админ, Оператор КТП, Инженер WFM, Клиент)
- **Критичность** - показатель важности обращения, влиящий на время реагирования. Имеет следующие типы:
     - **Basic** - базовое обращение невысокого уровня сложности, низкий вес в отображении обращений у сотрудника, дедлайн - 30 дней 
     - **Important** - важное обращение, требует глубокого анализа и/или дополнительных обращений или действий, средний вес в отображении обращений у сотрудника, дедлайн - 15 дней
     - **Critical** - критическое обращение, имеет серьезные последствия для предоставляемой услуги, требует быстрого реагирования, высокий вес в отображении обращений у сотрудника, дедлайн - 1 день
- **Статусы** - показатель выполнения обращения, отражающий его жизненный цикл. Имеет следующие типы:
     - **Created** - Исходное состояние задачи при ее создании
     - **Opened** - Задача открыта. Должен быть назначен менджер
     - **Customer Pending** -Ожидание заказчика. Например, составление договоров,настйроки удаленного доступа и тп.
     - **Done** - Работа по кейсу завершена. Ожидаем подверждение заявителя/клиента
     - **Verified** - Задача полностью завершена, подтверждена заказчиком. Переход в другие статусы невозможен

### 1.2 Общие архитектурные решения
- **Backend**: монолит на C++, фреймворк - Drogon
- **Frontend**: React
- **Data Base**: PostgreSQL

### 1.3 Команда проекта
- **CEO**: Кошелев Евгений Борисович 
- **Frontend**: Степаненко Денис, Лёшин Илья, Комаха Глеб, Слюта Андрей, Соромотин Михаил, Слесенко Андрей, Кошмин Андрей
- **Backend**: Тинов Михаил, Коровкин Владислав, Тихиня Илья
- **DevOps and Network engineers**: Плыс Михаил, Карташов Дмитрий, Шальнов Максим, Шакиро Иван
- **Analytics and Technical writers**: Морозов Александр,  Ренёв Михаил, Артёмов Даниил
- **Vibes specialist**: Комаха Глеб

## 2. Роли и права доступа 

| Модуль / Действие                                   | Админ | Оператор КТП      | Инженер WFM      | Клиент           |
|-----------------------------------------------------|:-----:|:-----------------:|:----------------:|:----------------:|
| **Обращения**                                        |       |              |             |        |
| – Просмотр всех обращений                            | ✓     | ✓ (КТП+WFM) | ✓ (КТП+WFM) | ✓ (только свои) |
| – Создание обращения                                 | ✓     | ✓ (тип КТП/WFM)  | ✓ (тип WFM) | ✓ (Выбор типа) |
| – Редактирование обращения                           | ✓     | ✓ (КТП + WFM)| ✓ (WFM)     | ✓     |
| – Изменение статуса/критичности                      | ✓     | ✓ (КТП)      | ✓ (WFM)     | ✓ + `Verified`/`Canceled` |
| – Добавление комментариев (в т.ч. с медиа)           | ✓     | ✓            | ✓           | ✓      |
| – Назначение ответственного                          | ✓     | ✓ (КТП)      | ✓ (WFM)     | ✗      |
| – Создание подзадачи                                 | ✓     | ✓ (КТП→КТП/WFM) | ✓ (WFM→WFM) | ✗      |
| – Трекинг времени                                    | ✓     | ✓            | ✓           | ✗      |
| **Сотрудники**                                       |       |               |             |        |
| – Просмотр списка сотрудников                        | ✓     | ✓            | ✓           | ✗      |
| – Добавление/удаление/редактирование сотрудника      | ✓     | ✗            | ✗           | ✗      |
| – Управление ролями                                  | ✓     | ✗            | ✗           | ✗      |
| – Управление отсутствиями/дежурствами                | ✓     | ✓            | ✓           | ✗      |
| **Клиенты**                                          |       |               |             |        |
| – Просмотр клиентов/представителей                   | ✓     | ✓            | ✓           | ✓ (только себя)|
| – Создание/редактирование клиентов/представителей    | ✓     | ✗            | ✗           | ✗      |
| **Площадки и оборудование**                          |       |               |              |        |
| – Просмотр единиц оборудования                       | ✓     | ✓            | ✓           | ✓ (только свои) |
| – Просмотр площадок                                  | ✓     | ✓            | ✓           | ✓ (только свои) |
| – Создание/редактирование/удаление площадок          | ✓     | ✗            | ✗           | ✗      |
| – Создание/редактирование/удаление ед.оборудования   | ✓     | ✗            | ✓           | ✗      |
| – Привязка ед.оборудования к площадке                | ✓     | ✗            | ✓           | ✗      |
| **Отчёты**                                           |       |               |              |        |
| – Формирование отчёта по времени                     | ✓     | ✓ (свои)     | ✓ (свои)    | ✗      |
| – Скачивание отчёта (Excel)                          | ✓     | ✓            | ✓           | ✗      |
| **Доска задач**                                      |       |               |             |        |
| - Просмотр дашбордов                                 | ✓ (свои) | ✓  (свои) | ✓   (свои) |  ✓ (свои) |
| - Создание/Удаление/Редактирование дашбордов         | ✓ (свои) | ✓  (свои) | ✓   (свои) |  ✓ (свои) |
| - Возможность перетаскивать дашборды обращений       | ✓ (свои) | ✓  (свои) | ✓   (свои) |  ✓ (свои) |
| **Настройки профиля**                                |       |               |             |        |
| - Просмотр профиля                                   | ✓ (свои)     | ✓ (свои)           | ✓ (свои)         |  ✗     |
| - Редактирование фото профиля                        | ✓  (свои)   | ✓ (свои)           | ✓  (свои)         | ✗      |

## 3. Функциональные требования 
### Первая очередь (Ядро системы)
Цель - обеспечить выполнение базового процесса - «регистрация обращения → выполнение → закрытие» и заведение данных о сотрудниках компании, представителях клиента, площадках и единицах оборудования, привязанных к ней. Организовать доступ пользователей к веб-интерфейсу по созданным УЗ и разграничение функционала по ролям 

#### 3.1 Модуль «Обращения»
**Сущность «Обращение»:**
- **id** (уникальный, автоинкремент)
- **type** (КТП или WFM)
- **title** (строка, в зависимости от типа: КТП - CRM-N+1, WFM - Наряд-N+1)
- **description** (описание задачи)
- **comment_room_id** (уникальный, список комментариев обращения)
- **status_id** – см. глоссарий
- **priority_id** – см. глоссарий
- **catalog_id** (Список продуктов, по которым задается обращение, используется для индикации проблемы или вопроса)
- **client_id** (ссылка на клиента)
- **site_id** (ссылка на площадку)
- **responsible_id** (ссылка на сотрудника, ответственного за выполнение)
- **created_by** (ссылка на создателя (представителя (**representative_id**) или сотрудника (**responsible_id**)))
- **created_at**, **updated_at** (Время создания и время обновления(коментарий, статус и тп))
- **deadline** (вычисляется автоматически при создании на основе приоритета)

**Сущность «Комментарий»:**
- **comment_room_id** (ссылка на список комментариев обращения)
- **comment_id** (Комментарий)

**Функции:**
- Просмотр списка обращений с фильтрацией по статусу, приоритету, типу, компании и сотруднику согласно матрице ролей
- Создание обращения:
  - Для оператора КТП поля:
    - Описание;
    - Статус (default - Created;);
    - Критичность;
    - Продукт (Может быть пустым, если есть делает фильтрацию в поле выбора площадки, фильтруются те площадки, на которых есть этот продукт);
    - [Клиент; Представитель - не назначается, но виден для всех представителей клиента]; (Обращение может создаваться на имя компании, поэтому клиентом может быть компания, а представителем - сотрудник компании)
    - площадка;
    - тип проставляется автоматически КТП, заголовок в зависимости от типа CRM/Наряд-(N+1; N=0) 
  - Для инженера WFM: аналогично, тип WFM.
  - Для клиента: аналогично полям КТП; Помимо:
    - выбор типа (КТП или WFM)
    - Поля [Клиент; Представитель] заполняются по информации о компании представителя и его данных автоматически.
    - Площадка может быть как выбрана, так и не выбрана
    - Сотрудник не назначается;
    - Статус (default - Created)
- Редактирование обращения, изменение полей:
  - Площадка
  - Статус (Для пользователя с ролью - **Оператор WFM/КТП** недоступно изменение статуса обращений созданного пользователем с ролью **Клиент** в **Verified** и **Cancel**, в обращении в рамках компании - возможно, для пользователя с ролью - **Админ**, можно во всех случаях)
  - Критичность
  - Сотрудник
- Добавление текстовых комментариев с MarkDown разметкой с возможностью предпросмотра готового комментария
- Назначение сотрудника (только для обращений, где он ещё не назначен; после назначения изменить отвественного сотрудника может пользователь с ролью - Админ)
- Отображение истории изменений в обращении (Комментарий, назначение сотрудников, измение полей: статус, критичность и тп согласно возможности редактирования)
- Отображение дедлайна тикета согласно критичности
- Создание подзадачи (Будет идти отображение связанных обращений с текущим, главное условие - связать можно уже существующие обращения)

#### 3.2 Модуль «Сотрудники»
**Сущность «Сотрудник»:**
- **human_id** (ссылка на список представителей клиента, уникальный-дефолтный, компания - Рога и копыта)
- **responsible_id** (уникальный или автоинкремент)
- **responsible_name** (ФИО сотрудника)
- **responsible_Photo** (Фото сотрудника)
- **responsible_age** (Возраст сотрудника)
- **responsible_position** (Должность сотрудника)
- **responsible_tel** (Контактный номер телефона)
- **responsible_email** (Почтовый адрес)
- **role_id** (Роль)
- **login_id** (Логин для доступа к CRM)
- **password_id** (Пароль для доступа к CRM)

**Функции**
- Просмотр списка сотрудников и их данных:
  - Для пользователя с ролью - Оператор WFM/КТП:
     - Фото
     - ФИО
     - Возраст
     - Должность
     - Контактные номер телефона
     - Почтовый адрес
  - Для пользователя с ролью - Админ:
     - Аналогично данным Операторов
     - Роль
     - Логин для доступа к CRM
     - Пароль для доступа к CRM
- Создание, удаление, редактирование сотрудников по поля:
   - Фото
   - ФИО
   - Возраст
   - Должность
   - Контактный номер телефона
   - Почтовый адрес
   - Роль
   - Логин для доступа к CRM
   - Пароль для доступа к CRM (Если пусто - автоматически 10 символов)

#### 3.3 Модуль «Клиенты»
**Сущность «Клиент»:**
- **client_id** (уникальный или автоинкремент)
- **client_name** (Имя клиента - название компании клиента)
- **client_adress** (адрес компании клиента)
- **client_tel** (контактный номер телефона CEO клиента)
- **client_email** (Почтовый адрес CEO клиента)
- **human_id** (уникальный, список представителей клиента)
- **responsible_id** (В случае если client_id - default (Рога и копыта))
- **area_id** (уникальный, список площадок привязанных к клиенту)

**Сущность «Представитель клиента»:**
- **human_id** (уникальный или автоинкремент, ссылка на список представителей клиента)
- **representative_id** (уникальный или автоинкремент)
- **representative_name** (ФИО)
- **responsible_tel** (Контактный номер телефона)
- **responsible_email** (Почтовый адрес)
- **role_id** (Роль)
- **login_id** (уникальный, логин для доступа к CRM)
- **password_id** (Пароль для доступа к CRM)

**Функции**
- Просмотр списка клиентов:
  - Для пользователей с ролью Оператор WFM/КТП: название компании клиента, контактные данные, список представилей и их данные - ФИО, контактные данные
  - Для пользователей с ролью Админ: все тоже самое, что и у операторов, но также ему видны логин и пароль представителя 
- Возможность создать, редактировать клиента (только администратор) по следующим полям:
   - Название компании клиента
   - Контактный номер телефона клиента
   - Почтовый адрес клиента
- Возможность создать, редактировать представителей клиента по следующим полям:
   - ФИО
   - Контактные номер телефона
   - Почтовый адрес
   - Логин для доступа к CRM
   - Пароль для доступа к CRM (Если пусто - автоматически, 10 символов)
- Возможность удалять клиентов и представителей

#### 3.4 Модуль «Площадки и оборудование»

**Сущность «Площадка»:**
- **area_id** (ссылка на список площадок привязанных к клиенту)
- **site_id** (уникальный или автоинкремент)
- **site_adress** (Физический адрес площадки)
- **catalog_id** (Список продуктов предоставляемых по сайту, используется для фильтрации единиц оборудования)
- **client_id** (ссылка на Имя клиента - название компании клиента)
- **client_tel** (ссылка контактный номер телефона клиента)
- **client_email** (ссылка на Почтовый адрес клиента)
- **facility_id** (Список предоставляемых единиц оборудования)

**Сущность «Продукт»:**
- **catalog_id** (ссылка на список продуктов предоставляемых по конкретной площадке заказчика)
- **product_id** (ID продукта предоставляемый компанией)
- **devices_id** (ссылка список единиц оборудования)

**Сущность «Единица оборудования»:**
- **devices_id** (уникальное или автоинкремент, список единиц оборудования)
- **eq_id** (уникальное или автоинкремент, артикул единицы оборудования)
- **eq_type** (Тип единицы оборудования)
- **eq_weight** (Вес единицы борудования)
- **eq_name** (Название единицы оборудования)
- **eq_description** (Описание единицы оборудования)
- **eq_count** (Фактическое кол-во оборудования)

**Сущность «Предоставляемое оборудование»:**
- **facility_id** (ссылка на список предоставляемых единиц оборудованияя)
- **product_id** (ссылка на ID продукта предоставляемый компанией)
- **device_count** (Количество предоставляемых единиц оборудования)

**Функции**
- Просмотр списка единиц оборудования с фильтрацией по продукту
- Создание единицы оборудования по полям:
  - Продукт (см. глоссарий)
  - Артикул (см. глоссарий, генерируется автоинкрементом на основе продукта)
  - Тип единицы оборудования (см. глоссарий)
  - Вес единицы оборудования
  - Количество данной единицы оборудования
  - Название единицы оборудования
  - Текстовое описание единицы оборудования
- Просмотр списка площадок клиентов с фильтрацией по клиенту, продукту
- Создание площадки клиента по полям:
  - Клиент (Выбирается из выпадающего списка всех клиентов)
  - Контактный номер клиента (подтягивается автоматически с выбором клиента)
  - Почтовый адрес клиента (подтягивается автоматически с выбором клиента)
  - Предоставляемые продукты
- Возможность привязать единицу оборудования к площадке по полям:
  - Выбор единицы оборудования из выпадающего списка единиц оборудования на основании выбранного продукта
  - Количество предоставляемых площадке единиц оборудования (Не может быть больше, чем фактическое кол-во единицы оборудования)

#### 3.5 Модуль «Доска задач»
**Функции**
- Создание, редактирование, удаление дашбордов со списком задач по фильтру
- Дефолтный дашборд - **Мои обращения**, где отображается список обращений открытых на сотрудника
- Возможность перетаскивать дашборды обращений

#### 3.6 Модуль «Настройки профиля»
**Функции**
- Просмотр профиля пользователя 
- Редактирование фото профиля (Если есть, в зависимости от роли)

#### 3.7 Авторизация и аутентификация
- Вход по логину/паролю.
- Разграничение доступа на основе ролей

### 3.8 Интерфейс (Frontend)
- Навигационное меню: Обращения, Клиенты, Сотрудники, Площадки и оборудование, Настройки
- Основная страница - Список обращений выводимый модулем "Обращения"

### Вторая очередь
### Третья очередь

## 4. Нефункциональные требования
### 4.1. Производительность
- Время отклика API – не более 500 мс для типовых операций
- Поддержка одновременной работы до 50 пользователей
- Загрузка списка обращений (до 1000 записей) – не более 2 секунд

### 4.2. Безопасность
- Пароли хранятся в БД в хешированном виде
- Валидация входных данных на бэкенде

### 4.3 Поддержка браузеров
- Скорее всего там вообще везде норм будет, но все же в конце надо будет проверить на декстопе отображение и работу на всех браузерах

 




  
   
